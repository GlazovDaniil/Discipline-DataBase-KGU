SELECT КодГр, Фам, Имя, Отчество, СрБалл FROM Students S INNER JOIN 
		(SELECT Knij, avg(Och/1.0) СрБалл 
		FROM (	SELECT Knij, Och FROM 
				(SELECT НомЗачКниж Knij, Оценка Och FROM Ocenki WHERE Оценка = '4' OR Оценка = '5' ) A LEFT JOIN
				(SELECT * FROM Ocenki WHERE Оценка = 'Незачтено' OR Оценка = '2' OR Оценка = '3') B 
				ON A.Knij = B.НомЗачКниж WHERE B.НомЗачКниж IS NULL) O
		GROUP BY Knij
		HAVING avg(Och/1.0) >= 4.75) O 
	ON S.НомЗачКниж = O.Knij
	WHERE  КодГр = '21-КБ-5'
	ORDER BY СрБалл DESC

//Изначально формируются две таблицы: удовлетворяющая "А" и неудовлетворяющая "В" условию оценки студента. Затем, они соеденяются, 
в результате чего получается таблица "О" с номером зачетных книжек и оценками, которые удовлетворяют условию: номера зачетных нижек только тех студентов, которые имеют 4 или 5,
и не имеют 2, 3 или "Незачтено". Из полученной таблицы "О" формируется таблица, где каждой зачетной книжке соответсвует ее средний бал и он больше или 
равен 4,75. Из той таблицы формируется конечная таблица, в которой сапоставляются ФИО студента, код группы и средний бал этого студента, а так же производится выборка ответа 
по коду группы.